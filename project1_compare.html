<!--This is section for comparing regions & animating scatterplot-->
<!DOCTYPE html>
<html>
<head>
	<title>Compare regions </title>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/4.1.2/papaparse.min.js" charset="utf-8"></script>
	<style>
    	text { 
			font-family: Arial; 
			font-size: 15px;
		}
		.axis path, .axis line {
			fill: none;
			stroke: black;
			shape-rendering: crispEdges;
		}
		.tick text {
			fill: black;
			font-size: 11px;
		}
		  .lines {
            stroke: black;
        }

	</style>
</head>
<body>
	
<svg id="main" width="1800" height="1200">
<!--display default page
		//title of the page
		//title SCATTERPLOT
		//button start animation
		//button stop/resume animation
		//pass value 0 and 1 everytime it gets clicked. use it to see if the animation is moving or not currently
		//dividing line
		//title Bar/line chart
		//dropdown for bar/line chart
		
		//a dropdown for energy type (this time, pro/con are not divided) -- if have time, divide.
		//a dropdown for region 1 (by default, this is WORLD) 
		//a dropdown for region 2
		//a dropdown for region 3 -- if have time
		
		//a button "Restore default" 
		//button "back to original chart"-->
		
		<!--circles for legend-->
		<!--set of titles-->
		<text id='titleData' class = 'menu' x='100' y='40' style= font-size:25></text>
		<text id="scale" class = "menu" x = '15' y='95' style= font-size:11></text>
		<text id="textVar1" x = "130" y="450" style= font-size:20></text>
		<text id="textVar2" x = "430" y="450" style= font-size:20></text>

		<!--<line x1="650" y1="80" x2="650" y2="420"
			stroke-width="1" stroke="black" shape-rendering= "crispEdges";/>-->
		<rect x="655" y="75" width="250" height="350" rx="15" ry="15" style="shape-rendering= crispEdges;fill:white;stroke:black;stroke-width:1;opacity:0.5" />	
		<rect x="665" y="85" width="230" height="330" rx="15" ry="15" style="opacity:0.2; fill:rgb(175, 175, 131)"/>	
		
		</svg>
		<text class = 'link' x = '180' y = '550' style= "font-size:15px;position: absolute; left: 100px;top: 500px;"><a href="https://239cda.github.io/H590project/documentation.html">Link to Documentation</a></text>
		<text class = 'link' x = '180' y = '550' style= "font-size:15px;position: absolute; left: 400px;top: 500px;"><a href="https://www.youtube.com/watch?v=tcXxEq143bg">Link to Video</a></text>
		<<text id='titleYearMenu' class = 'menu' style="position: absolute; left: 680px; top: 100px; font-size:17px">Animate Regional Trend</text>
		
		
		<!--<button id="buttonPauseAnimation" style="position: absolute; left: 700px; top: 130px">Pause/Resume</button>-->
		<!--<button id="buttonTest" style="position: absolute; left: 680px; top: 50px">test</button>-->
		
		<select id="chartType" style="position: absolute; left: 680px; top: 200px">
		<option selected="selected">Dotted Graph</option>
		<option>Bar Chart</option>
		<option>Line Chart</option>
		</select>
		
		<select id="energyType" style="position: absolute; left: 680px; top: 230px">
		<option selected="selected" id = "localities">Total Primary Energy Production</option>
		<option id = "localitiesEnCon">Total Primary Energy Consumption</option>
		<option id = "localitiesElectPro">Total Electricity Production</option>
		<option id = "localitiesElectCon">Total Electricity Consumption</option>
		<option id = "localitiesRenewElectPro">Renewable Electricity Production</option>
		<option id = "localitiesRenewElectCon">Renewable Electricity Consumption</option>
		<option id = "localitiesRenewBioPro">Renewable Biofuel Production</option>
		<option id = "localitiesRenewBioCon">Renewable Biofuel Consumption</option>
		<option id = "localitiesCoalPro">Coal Production</option>
		<option id = "localitiesCoalCon">Coal Consumption</option>
		<option id = "localitiesPetroPro">Petroleum Production</option>
		<option id = "localitiesPetroCon">Petroleum Consumption</option>
		<option id = "localitiesCO2">CO2 Emission per Capita</option>
		</select>
		
		<select id="region1" name = "chart" style="position: absolute; left: 680px; top: 260px">
		<option hidden>---Select---</option>
		<option>North America</option>
		<option>Central & South America</option>
		<option>Europe</option>
		<option>Eurasia</option>
		<option>Africa</option>
		<option>Asia & Oceania</option>
		<option selected ="selected" >World</option>
		</select>
		<select id="region2" name = "chart" style="position: absolute; left: 680px; top: 280px">
		<option hidden>---Select---</option>
		<option selected ="selected" >North America</option>
		<option>Central & South America</option>
		<option>Europe</option>
		<option>Eurasia</option>
		<option>Africa</option>
		<option>Asia & Oceania</option>
		<option>World</option>
		</select>
		
		
		<button id="buttonComparison" onclick="window.open('https://239cda.github.io/H590project/index.html')"name = "chart" style="position: absolute; left: 680px; top: 350px">Back to Original Chart</button>
	<script>
		//variables for data storage
		//attempt to enable selecting regions as well as locations, but seems there wouldn't be time to finish this. 
		
		var listOfLocalities = [];
		var localityForDropbox = [];

		var localities = {};//total energy production
		var localitiesEnCon = {};//total energy consumption
		var localitiesCO2 = {};
		var localitiesCoalPro = {};
		var localitiesCoalCon = {};
		var localitiesPetroPro = {};
		var localitiesPetroCon = {};
		var localitiesRenewBioPro = {};
		var localitiesRenewBioCon = {};
		var localitiesRenewElectPro = {};
		var localitiesRenewElectCon = {};
		var localitiesElectPro = {};
		var localitiesElectCon = {};

		//attempt to enable selecting regions as well as locations, but seems there wouldn't be time to finish this. 
		//localityForDropbox.unshift("North America", "Central & South America", "Europe", "Eurasia", "Africa", "Asia & Oceania", "World");
		
		/*console.log(localityForDropbox)
		console.log(Object.getOwnPropertyNames(localityForDropbox))	
		//console.log(Object.values(localityForDropbox))
		
		//also insert '-----------' to seperate one region from others
		//when'-----' is selected, throw a pop up screen saying select again. Without this line of code, it will throw EERRRRRRRORRRR!*/
		
		
		//bring in data in each csv files
		Papa.parse('https://239cda.github.io/H590project/total_primary_energy_production.csv', {
			download: true,
			header: true,
			dynamicTyping: true,
			complete: function(results) 
			{
				// loop through all the rows in file
				for (var row=0; row < results.data.length; row++)
				{
					var record = results.data[row];
					
					// make an object to store data for the current locality
					var locality = {
						name: record.Locality,
						energyProduction: []
					}

					// loop through all years, from 1980 to 2012
					for (var year=1980; year<=2012; year++) 
					{
						var value = record[year];

						// deal with missing data points
						if (value === '--') {
							value = 0;
						}
						else if (value === 'NA') {
							value = 0;
						}
						else if (value === '(s)') {
							value = 0;
						}
						else if (value === 'W') {
							value = 0;
						}

						// add record of current energy production
						locality.energyProduction.push( value );
					}

					// add the current locality to an index
					localities[ locality.name] = locality;
					listOfLocalities.push( locality.name );
					localityForDropbox.push( locality.name );
					
				}
				
			Papa.parse('https://239cda.github.io/H590project/total_primary_energy_consumption.csv', {
			download: true,
			header: true,
			dynamicTyping: true,
			complete: function(results) 
			{
				// loop through all the rows in file
				for (var row=0; row < results.data.length; row++)
				{
					var record = results.data[row];
					
					// make an object to store data for the current locality
					var locality = {
						name: record.Locality,
						energyProduction: []
					}

					// loop through all years, from 1980 to 2012
					for (var year=1980; year<=2012; year++) 
					{
						var value = record[year];

						// deal with missing data points
						if (value === '--') {
							value = 0;
						}
						else if (value === 'NA') {
							value = 0;
						}
						else if (value === '(s)') {
							value = 0;
						}
						else if (value === 'W') {
							value = 0;
						}

						// add record of current energy production
						locality.energyProduction.push( value );
					}

					// add the current locality to an index
					localitiesEnCon[ locality.name] = locality;
					listOfLocalities.push( locality.name );
				}
			Papa.parse('https://239cda.github.io/H590project/co2_emissions_per_capita.csv', {
		
			download: true,
			header: true,
			dynamicTyping: true,
			complete: function(results) 
			{
				// loop through all the rows in file
				for (var row=0; row < results.data.length; row++)
				{
					var record = results.data[row];
					
					// make an object to store data for the current locality
					var locality = {
						name: record.Locality,
						energyProduction: []
					}

					// loop through all years, from 1980 to 2012
					for (var year=1980; year<=2012; year++) 
					{
						var value = record[year];

						// deal with missing data points
						if (value === '--') {
							value = 0;
						}
						else if (value === 'NA') {
							value = 0;
						}
						else if (value === '(s)') {
							value = 0;
						}
						else if (value === 'W') {
							value = 0;
						}

						// add record of current energy production
						locality.energyProduction.push( value );
					}

					// add the current locality to an index
					localitiesCO2[ locality.name] = locality;
					listOfLocalities.push( locality.name );
				}
			Papa.parse('https://239cda.github.io/H590project/coal_consumption.csv', {
		
			download: true,
			header: true,
			dynamicTyping: true,
			complete: function(results) 
			{
				// loop through all the rows in file
				for (var row=0; row < results.data.length; row++)
				{
					var record = results.data[row];
					
					// make an object to store data for the current locality
					var locality = {
						name: record.Locality,
						energyProduction: []
					}

					// loop through all years, from 1980 to 2012
					for (var year=1980; year<=2012; year++) 
					{
						var value = record[year];

						// deal with missing data points
						if (value === '--') {
							value = 0;
						}
						else if (value === 'NA') {
							value = 0;
						}
						else if (value === '(s)') {
							value = 0;
						}
						else if (value === 'W') {
							value = 0;
						}

						// add record of current energy production
						locality.energyProduction.push( value );
					}

					// add the current locality to an index
					localitiesCoalCon[ locality.name] = locality;
					listOfLocalities.push( locality.name );
				}
			
			
			Papa.parse('https://239cda.github.io/H590project/coal_production.csv', {
		
			download: true,
			header: true,
			dynamicTyping: true,
			complete: function(results) 
			{
				// loop through all the rows in file
				for (var row=0; row < results.data.length; row++)
				{
					var record = results.data[row];
					
					// make an object to store data for the current locality
					var locality = {
						name: record.Locality,
						energyProduction: []
					}

					// loop through all years, from 1980 to 2012
					for (var year=1980; year<=2012; year++) 
					{
						var value = record[year];

						// deal with missing data points
						if (value === '--') {
							value = 0;
						}
						else if (value === 'NA') {
							value = 0;
						}
						else if (value === '(s)') {
							value = 0;
						}
						else if (value === 'W') {
							value = 0;
						}

						// add record of current energy production
						locality.energyProduction.push( value );
					}

					// add the current locality to an index
					localitiesCoalPro[ locality.name] = locality;
					listOfLocalities.push( locality.name );
				}
			Papa.parse('https://239cda.github.io/H590project/petroleum_consumption.csv', {
		
			download: true,
			header: true,
			dynamicTyping: true,
			complete: function(results) 
			{
				// loop through all the rows in file
				for (var row=0; row < results.data.length; row++)
				{
					var record = results.data[row];
					
					// make an object to store data for the current locality
					var locality = {
						name: record.Locality,
						energyProduction: []
					}

					// loop through all years, from 1980 to 2012
					for (var year=1980; year<=2012; year++) 
					{
						var value = record[year];

						// deal with missing data points
						if (value === '--') {
							value = 0;
						}
						else if (value === 'NA') {
							value = 0;
						}
						else if (value === '(s)') {
							value = 0;
						}
						else if (value === 'W') {
							value = 0;
						}

						// add record of current energy production
						locality.energyProduction.push( value );
					}

					// add the current locality to an index
					localitiesPetroCon[ locality.name] = locality;
					listOfLocalities.push( locality.name );
				}
			Papa.parse('https://239cda.github.io/H590project/petroleum_production.csv', {
		
			download: true,
			header: true,
			dynamicTyping: true,
			complete: function(results) 
			{
				// loop through all the rows in file
				for (var row=0; row < results.data.length; row++)
				{
					var record = results.data[row];
					
					// make an object to store data for the current locality
					var locality = {
						name: record.Locality,
						energyProduction: []
					}

					// loop through all years, from 1980 to 2012
					for (var year=1980; year<=2012; year++) 
					{
						var value = record[year];

						// deal with missing data points
						if (value === '--') {
							value = 0;
						}
						else if (value === 'NA') {
							value = 0;
						}
						else if (value === '(s)') {
							value = 0;
						}
						else if (value === 'W') {
							value = 0;
						}

						// add record of current energy production
						locality.energyProduction.push( value );
					}

					// add the current locality to an index
					localitiesPetroPro[ locality.name] = locality;
					listOfLocalities.push( locality.name );
				}
			Papa.parse('https://239cda.github.io/H590project/renewable_biofuel_consumption.csv', {
		
			download: true,
			header: true,
			dynamicTyping: true,
			complete: function(results) 
			{
				// loop through all the rows in file
				for (var row=0; row < results.data.length; row++)
				{
					var record = results.data[row];
					
					// make an object to store data for the current locality
					var locality = {
						name: record.Locality,
						energyProduction: []
					}

					// loop through all years, from 1980 to 2012
					for (var year=1980; year<=2012; year++) 
					{
						var value = record[year];

						// deal with missing data points
						if (value === '--') {
							value = 0;
						}
						else if (value === 'NA') {
							value = 0;
						}
						else if (value === '(s)') {
							value = 0;
						}
						else if (value === 'W') {
							value = 0;
						}

						// add record of current energy production
						locality.energyProduction.push( value );
					}

					// add the current locality to an index
					localitiesRenewBioCon[ locality.name] = locality;
					listOfLocalities.push( locality.name );
				}
			Papa.parse('https://239cda.github.io/H590project/renewable_biofuel_production.csv', {
		
			download: true,
			header: true,
			dynamicTyping: true,
			complete: function(results) 
			{
				// loop through all the rows in file
				for (var row=0; row < results.data.length; row++)
				{
					var record = results.data[row];
					
					// make an object to store data for the current locality
					var locality = {
						name: record.Locality,
						energyProduction: []
					}

					// loop through all years, from 1980 to 2012
					for (var year=1980; year<=2012; year++) 
					{
						var value = record[year];
						
						// deal with missing data points
						if (value === '--') {
							value = 0;
						}
						else if (value === 'NA') {
							value = 0;
						}
						else if (value === '(s)') {
							value = 0;
						}
						else if (value === 'W') {
							value = 0;
						}

						// add record of current energy production
						locality.energyProduction.push( value );
					}

					// add the current locality to an index
					localitiesRenewBioPro[ locality.name] = locality;
					listOfLocalities.push( locality.name );
				}
			Papa.parse('https://239cda.github.io/H590project/renewable_electricity_consumption.csv', {
		
			download: true,
			header: true,
			dynamicTyping: true,
			complete: function(results) 
			{
				// loop through all the rows in file
				for (var row=0; row < results.data.length; row++)
				{
					var record = results.data[row];
					
					// make an object to store data for the current locality
					var locality = {
						name: record.Locality,
						energyProduction: []
					}

					// loop through all years, from 1980 to 2012
					for (var year=1980; year<=2012; year++) 
					{
						var value = record[year];

						// deal with missing data points
						if (value === '--') {
							value = 0;
						}
						else if (value === 'NA') {
							value = 0;
						}
						else if (value === '(s)') {
							value = 0;
						}
						else if (value === 'W') {
							value = 0;
						}

						// add record of current energy production
						locality.energyProduction.push( value );
					}

					// add the current locality to an index
					localitiesRenewElectCon[ locality.name] = locality;
					listOfLocalities.push( locality.name );
				}
			Papa.parse('https://239cda.github.io/H590project/renewable_electricity_generation.csv', {
		
			download: true,
			header: true,
			dynamicTyping: true,
			complete: function(results) 
			{
				// loop through all the rows in file
				for (var row=0; row < results.data.length; row++)
				{
					var record = results.data[row];
					
					// make an object to store data for the current locality
					var locality = {
						name: record.Locality,
						energyProduction: []
					}

					// loop through all years, from 1980 to 2012
					for (var year=1980; year<=2012; year++) 
					{
						var value = record[year];

						// deal with missing data points
						if (value === '--') {
							value = 0;
						}
						else if (value === 'NA') {
							value = 0;
						}
						else if (value === '(s)') {
							value = 0;
						}
						else if (value === 'W') {
							value = 0;
						}

						// add record of current energy production
						locality.energyProduction.push( value );
					}

					// add the current locality to an index
					localitiesRenewElectPro[ locality.name] = locality;
					listOfLocalities.push( locality.name );
				}
			Papa.parse('https://239cda.github.io/H590project/total_electricity_consumption.csv', {
		
			download: true,
			header: true,
			dynamicTyping: true,
			complete: function(results) 
			{
				// loop through all the rows in file
				for (var row=0; row < results.data.length; row++)
				{
					var record = results.data[row];
					
					// make an object to store data for the current locality
					var locality = {
						name: record.Locality,
						energyProduction: []
					}

					// loop through all years, from 1980 to 2012
					for (var year=1980; year<=2012; year++) 
					{
						var value = record[year];

						// deal with missing data points
						if (value === '--') {
							value = 0;
						}
						else if (value === 'NA') {
							value = 0;
						}
						else if (value === '(s)') {
							value = 0;
						}
						else if (value === 'W') {
							value = 0;
						}

						// add record of current energy production
						locality.energyProduction.push( value );
					}

					// add the current locality to an index
					localitiesElectCon[ locality.name] = locality;
					listOfLocalities.push( locality.name );
				}
			Papa.parse('https://239cda.github.io/H590project/total_electricity_generation.csv', {
		
			download: true,
			header: true,
			dynamicTyping: true,
			complete: function(results) 
			{
				// loop through all the rows in file
				for (var row=0; row < results.data.length; row++)
				{
					var record = results.data[row];
					
					// make an object to store data for the current locality
					var locality = {
						name: record.Locality,
						energyProduction: []
					}

					// loop through all years, from 1980 to 2012
					for (var year=1980; year<=2012; year++) 
					{
						var value = record[year];

						// deal with missing data points
						if (value === '--') {
							value = 0;
						}
						else if (value === 'NA') {
							value = 0;
						}
						else if (value === '(s)') {
							value = 0;
						}
						else if (value === 'W') {
							value = 0;
						}

						// add record of current energy production
						locality.energyProduction.push( value );
					}

					// add the current locality to an index
					localitiesElectPro[ locality.name] = locality;
					listOfLocalities.push( locality.name );
				}
			}})
			}})
			}})
			}})
			}})
			}})
			}})
			}})
			}})
			}})
			}})
			}})
			
///////////////////////////////			
//////end of data retrieval////
///////////////////////////////			
//UNCOMMENT if there is time to add locations
			//add data to drop boxes
			/*d3.select('#region1').selectAll('option').data(localityForDropbox).enter().append('option')
					.html(function(d) { return d; })
					.attr('value', function(d) { return d; })
					
			d3.select('#region2').selectAll('option').data(localityForDropbox).enter().append('option')
					.html(function(d) { return d; })
					.attr('value', function(d) { return d; })*/
					
			//on loading, by default, an animated scatterplot will play.
				//if energy type is changed, change display with all localities just keep moving
				//if region is changed, remove all localities except the one just selcted
					//when the other region is changed, display it
					//from then, when localities change, just two localities display.
				//if chart type is changed, draw defalut chart for each (world and north america)
			//when scatterplot is selected again, check for current value for dropdowns and display accordingly
			//when clicking animation, start animation (same as the default state)
		
			drawScatter("World", "North America", localities);

			//two buttons that control start/stop of animation
			d3.select("#buttonStartAnimation")
				.on('click', function(){
					d3.select("#main").selectAll('g').remove();
					drawAnimatedScatter(localities)
					}
				)
//IF HAVE TIME (pausing/resuming animation)
			//disable dropdown for animation scaterplot
			
			//dropbox for energyType. Here, when user changes selction, a graph will be redrawn
				d3.select("#energyType")
				   .on('change', function(){
				   // clear the contents of the chart
						//if animation scatterplot is on, just change its energy type
						var selection=document.getElementById("chartType");
						var selectedChartType=selection.options[selection.selectedIndex].value;

						// figure out the newly selected enegy type, region, chart type
						var selection = document.getElementById('region1');
						var selectedRegion1 = selection.options[selection.selectedIndex].value;

						var selection= document.getElementById('region2');
					    var selectedRegion2	= selection.options[selection.selectedIndex].value;

						//have to connect selection of energy type with the dataset of that energy type
						var selection= document.getElementById('energyType');
					    var selectedEnergyId = selection.options[selection.selectedIndex].id;
							if (selectedEnergyId == "localities") {selectedEnergyId = localities;}
							else if (selectedEnergyId == "localitiesCO2") {selectedEnergyId = localitiesCO2;}
							else if (selectedEnergyId == "localitiesCoalCon") {selectedEnergyId = localitiesCoalCon;}
							else if (selectedEnergyId == "localitiesCoalPro") {selectedEnergyId = localitiesCoalPro;}
							else if (selectedEnergyId == "localitiesElectCon") {selectedEnergyId = localitiesElectCon;}
							else if (selectedEnergyId == "localitiesElectPro") {selectedEnergyId = localitiesElectPro;}
							else if (selectedEnergyId == "localitiesEnCon") {selectedEnergyId = localitiesEnCon;}
							else if (selectedEnergyId == "localitiesPetroCon") {selectedEnergyId = localitiesPetroCon;}
							else if (selectedEnergyId == "localitiesPetroPro") {selectedEnergyId = localitiesPetroPro;}
							else if (selectedEnergyId == "localitiesRenewBioCon") {selectedEnergyId = localitiesRenewBioCon;}
							else if (selectedEnergyId == "localitiesRenewBioPro") {selectedEnergyId = localitiesRenewBioPro;}
							else if (selectedEnergyId == "localitiesRenewElectCon") {selectedEnergyId = localitiesRenewElectCon;}
							else if (selectedEnergyId == "localitiesRenewElectPro") {selectedEnergyId = localitiesRenewElectPro;}
					
						d3.select("#main").selectAll('g').remove();
						
						var checkSelection = function (selectedRegion1, selectedRegion2, selectedEnergyId, selectedChartType) {
							if (selectedChartType == "Bar Chart"){
							drawBar(selectedRegion1, selectedRegion2, selectedEnergyId)
							}
							else if(selectedChartType == "Line Chart"){
							drawLine(selectedRegion1, selectedRegion2, selectedEnergyId)
							}
							else if(selectedChartType == "Scatterplot"){
							drawScatter(selectedRegion1, selectedRegion2, selectedEnergyId)
							}
							else if(selectedChartType == "Animated Scatterplot"){
							drawAnimatedScatter(selectedEnergyId)}
						}
						checkSelection(selectedRegion1, selectedRegion2, selectedEnergyId, selectedChartType);
					}
				)
			//change chart type when changed
				d3.select("#chartType")
				   .on('change', function(){
				   // clear the contents of the chart
						d3.select("#main").selectAll('g').remove();

						// figure out the newly selected enegy type, region, chart type
						var selection = document.getElementById('region1');
						var selectedRegion1 = selection.options[selection.selectedIndex].value;

						var selection= document.getElementById('region2');
					    var selectedRegion2	= selection.options[selection.selectedIndex].value;

						//have to connect selection of energy type with the dataset of that energy type
						var selection= document.getElementById('energyType');
					    var selectedEnergyId = selection.options[selection.selectedIndex].id;
							if (selectedEnergyId == "localities") {selectedEnergyId = localities;}
							else if (selectedEnergyId == "localitiesCO2") {selectedEnergyId = localitiesCO2;}
							else if (selectedEnergyId == "localitiesCoalCon") {selectedEnergyId = localitiesCoalCon;}
							else if (selectedEnergyId == "localitiesCoalPro") {selectedEnergyId = localitiesCoalPro;}
							else if (selectedEnergyId == "localitiesElectCon") {selectedEnergyId = localitiesElectCon;}
							else if (selectedEnergyId == "localitiesElectPro") {selectedEnergyId = localitiesElectPro;}
							else if (selectedEnergyId == "localitiesEnCon") {selectedEnergyId = localitiesEnCon;}
							else if (selectedEnergyId == "localitiesPetroCon") {selectedEnergyId = localitiesPetroCon;}
							else if (selectedEnergyId == "localitiesPetroPro") {selectedEnergyId = localitiesPetroPro;}
							else if (selectedEnergyId == "localitiesRenewBioCon") {selectedEnergyId = localitiesRenewBioCon;}
							else if (selectedEnergyId == "localitiesRenewBioPro") {selectedEnergyId = localitiesRenewBioPro;}
							else if (selectedEnergyId == "localitiesRenewElectCon") {selectedEnergyId = localitiesRenewElectCon;}
							else if (selectedEnergyId == "localitiesRenewElectPro") {selectedEnergyId = localitiesRenewElectPro;}
							
						var selection=document.getElementById("chartType");
						var selectedChartType=selection.options[selection.selectedIndex].value;
						
						var checkSelection = function (selectedRegion1, selectedRegion2, selectedEnergyId, selectedChartType) {
							if (selectedChartType == "Bar Chart"){
							drawBar(selectedRegion1, selectedRegion2, selectedEnergyId)
							}
							else if(selectedChartType == "Line Chart"){
							drawLine(selectedRegion1, selectedRegion2, selectedEnergyId)
							}
							else if(selectedChartType == "Scatterplot"){
							drawScatter(selectedRegion1, selectedRegion2, selectedEnergyId)
							}
							else if(selectedChartType == "Animated Scatterplot"){
							drawAnimatedScatter(selectedEnergyId)}
						}
						checkSelection(selectedRegion1, selectedRegion2, selectedEnergyId, selectedChartType);
					}
				)			
			
			//change regions when changed
			d3.select("#region1")
				   .on('change', function(){
				   // clear the contents of the chart
						d3.select("#main").selectAll('g').remove();

						// figure out the newly selected enegy type, region, chart type
						var selection = document.getElementById('region1');
						var selectedRegion1 = selection.options[selection.selectedIndex].value;

						var selection= document.getElementById('region2');
					    var selectedRegion2	= selection.options[selection.selectedIndex].value;
						
						//have to connect selection of energy type with the dataset of that energy type
						var selection= document.getElementById('energyType');
					    var selectedEnergyId = selection.options[selection.selectedIndex].id;
							if (selectedEnergyId == "localities") {selectedEnergyId = localities;}
							else if (selectedEnergyId == "localitiesCO2") {selectedEnergyId = localitiesCO2;}
							else if (selectedEnergyId == "localitiesCoalCon") {selectedEnergyId = localitiesCoalCon;}
							else if (selectedEnergyId == "localitiesCoalPro") {selectedEnergyId = localitiesCoalPro;}
							else if (selectedEnergyId == "localitiesElectCon") {selectedEnergyId = localitiesElectCon;}
							else if (selectedEnergyId == "localitiesElectPro") {selectedEnergyId = localitiesElectPro;}
							else if (selectedEnergyId == "localitiesEnCon") {selectedEnergyId = localitiesEnCon;}
							else if (selectedEnergyId == "localitiesPetroCon") {selectedEnergyId = localitiesPetroCon;}
							else if (selectedEnergyId == "localitiesPetroPro") {selectedEnergyId = localitiesPetroPro;}
							else if (selectedEnergyId == "localitiesRenewBioCon") {selectedEnergyId = localitiesRenewBioCon;}
							else if (selectedEnergyId == "localitiesRenewBioPro") {selectedEnergyId = localitiesRenewBioPro;}
							else if (selectedEnergyId == "localitiesRenewElectCon") {selectedEnergyId = localitiesRenewElectCon;}
							else if (selectedEnergyId == "localitiesRenewElectPro") {selectedEnergyId = localitiesRenewElectPro;}
							
						var selection=document.getElementById("chartType");
						var selectedChartType=selection.options[selection.selectedIndex].value;
						
						var checkSelection = function (selectedRegion1, selectedRegion2, selectedEnergyId, selectedChartType) {
							if (selectedChartType == "Bar Chart"){
							drawBar(selectedRegion1, selectedRegion2, selectedEnergyId)
							}
							
							else if(selectedChartType == "Line Chart"){
							drawLine(selectedRegion1, selectedRegion2, selectedEnergyId)
							}
							else if(selectedChartType == "Scatterplot"){
							drawScatter(selectedRegion1, selectedRegion2, selectedEnergyId)
							}
						}
						checkSelection(selectedRegion1, selectedRegion2, selectedEnergyId, selectedChartType);
						
					}
				)
			//change regions when changed
			d3.select("#region2")
				   .on('change', function(){
				   // clear the contents of the chart
						d3.select("#main").selectAll('g').remove();

						// figure out the newly selected enegy type, region, chart type
						var selection = document.getElementById('region1');
						var selectedRegion1 = selection.options[selection.selectedIndex].value;

						var selection= document.getElementById('region2');
					    var selectedRegion2	= selection.options[selection.selectedIndex].value;
						
						//have to connect selection of energy type with the dataset of that energy type
						var selection= document.getElementById('energyType');
					    var selectedEnergyId = selection.options[selection.selectedIndex].id;
							if (selectedEnergyId == "localities") {selectedEnergyId = localities;}
							else if (selectedEnergyId == "localitiesCO2") {selectedEnergyId = localitiesCO2;}
							else if (selectedEnergyId == "localitiesCoalCon") {selectedEnergyId = localitiesCoalCon;}
							else if (selectedEnergyId == "localitiesCoalPro") {selectedEnergyId = localitiesCoalPro;}
							else if (selectedEnergyId == "localitiesElectCon") {selectedEnergyId = localitiesElectCon;}
							else if (selectedEnergyId == "localitiesElectPro") {selectedEnergyId = localitiesElectPro;}
							else if (selectedEnergyId == "localitiesEnCon") {selectedEnergyId = localitiesEnCon;}
							else if (selectedEnergyId == "localitiesPetroCon") {selectedEnergyId = localitiesPetroCon;}
							else if (selectedEnergyId == "localitiesPetroPro") {selectedEnergyId = localitiesPetroPro;}
							else if (selectedEnergyId == "localitiesRenewBioCon") {selectedEnergyId = localitiesRenewBioCon;}
							else if (selectedEnergyId == "localitiesRenewBioPro") {selectedEnergyId = localitiesRenewBioPro;}
							else if (selectedEnergyId == "localitiesRenewElectCon") {selectedEnergyId = localitiesRenewElectCon;}
							else if (selectedEnergyId == "localitiesRenewElectPro") {selectedEnergyId = localitiesRenewElectPro;}
							
						var selection=document.getElementById("chartType");
						var selectedChartType=selection.options[selection.selectedIndex].value;
						
						var checkSelection = function (selectedRegion1, selectedRegion2, selectedEnergyId, selectedChartType) {
							if (selectedChartType == "Bar Chart"){
							drawBar(selectedRegion1, selectedRegion2, selectedEnergyId)
							}
							else if(selectedChartType == "Line Chart"){
							drawLine(selectedRegion1, selectedRegion2, selectedEnergyId)
							}
							else if(selectedChartType == "Scatterplot"){
							drawScatter(selectedRegion1, selectedRegion2, selectedEnergyId)
							}
						}
						checkSelection(selectedRegion1, selectedRegion2, selectedEnergyId, selectedChartType);
						
					}
				)
			
////////////////////anything that should go inside complete function go above here
			}});		
//LATER			
//a scatterplot containing data for each region displayed at once (by defalut)
		//create scatter drawing function for each of them
		//for x and y position, use a for loop to i++ everytime until it reaches end of the year (2012)
		//what is passed would be : energyType, region name
		
		//two types will be played : 1. animation with all regions 2. static version with only 2 regions
	function drawAnimatedScatter(energyType){
			disableRegion1();
			disableRegion2();
			document.getElementById("region1").value = "---Select---"
			document.getElementById("region2").value = "---Select---"
			
			
		//seven different regions.
		//so seven datasets that refer to same energy type(which can be changed)
			var prepareData1 = energyType["North America"].energyProduction;	
			var prepareData2 = energyType["Central & South America"].energyProduction;	
			var prepareData3 = energyType["Europe"].energyProduction;	
			var prepareData4 = energyType["Eurasia"].energyProduction;	
			var prepareData5 = energyType["Africa"].energyProduction;	
			var prepareData6 = energyType["Asia & Oceania"].energyProduction;	
			//var prepareData7 = energyType["World"].energyProduction;	

			var beginValue = [];
				beginValue.push(prepareData1[0])
				beginValue.push(prepareData2[0])
				beginValue.push(prepareData3[0])
				beginValue.push(prepareData4[0])
				beginValue.push(prepareData5[0])
				beginValue.push(prepareData6[0])
				//beginValue.push(prepareData7[1])
			
			var colorArray = ["#d73027", "#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4"];
			console.log(colorArray)
			//calculated maximum value here.
			
			var maxValueArray = [];
			
			maxValueArray.push(d3.max(prepareData1))
			maxValueArray.push(d3.max(prepareData2))
			maxValueArray.push(d3.max(prepareData3))
			maxValueArray.push(d3.max(prepareData4))
			maxValueArray.push(d3.max(prepareData5))
			maxValueArray.push(d3.max(prepareData6))
			
			
			var maxProduction = d3.max(maxValueArray);
			
			//create title
	var selection= document.getElementById('energyType');
	var selectedEnergy = selection.options[selection.selectedIndex].value;

	var scaleDisplay = '';
			function dp (energyType) {
				if(energyType == localities) {scaleDisplay ="(Quadrillion BTU)"}
				else if(energyType == localitiesEnCon) {scaleDisplay ="(Quadrillion BTU)"}
				else if(energyType == localitiesElectPro) {scaleDisplay = "(billion Kilowatt-hours)"}
				else if(energyType == localitiesElectCon) {scaleDisplay = "(billion Kilowatt-hours)"}
				else if(energyType == localitiesRenewElectPro) {scaleDisplay = "(billion Kilowatt-hours)"}
				else if(energyType == localitiesRenewElectCon) {scaleDisplay = "(billion Kilowatt-hours)"}
				else if(energyType == localitiesRenewBioPro) {scaleDisplay = "(thousand barrels per day)"}
				else if(energyType == localitiesRenewBioCon) {scaleDisplay = "(thousand barrels per day)"}
				else if(energyType == localitiesPetroPro) {scaleDisplay = "(thousand barrels per day)"}
				else if(energyType == localitiesPetroCon) {scaleDisplay = "(thousand barrels per day)"}
				else if(energyType == localitiesCoalPro) {scaleDisplay = "(million short tons)"}
				else if(energyType == localitiesCoalCon) {scaleDisplay = "(million short tons)"}
				else if(energyType == localitiesCO2) {scaleDisplay = "(metric tons per capita)"}
			}
	dp (energyType);
	
	//putting titles in
	d3.select("#titleData")
	   .html(selectedEnergy)//add here which year is displayed
	d3.select("#scale")
	   .html(scaleDisplay)

	   
	   
	   
			//chart size
			var chartWidth = 500;
			var chartHeight = 300;
			//var scatterWidth = (chartWidth / (dataset.length));
			var group = d3.select("#main").append("g")
              .attr("transform", "translate(100, 100)");
			  
			var yScale = d3.scale.linear()
				.domain([0, maxProduction])
				.range([chartHeight, 0] ); 
				
			var line = d3.svg.line()
	                .x(function(d) {return 0})
					//this should apply to dataset with less years
					.y(function(d){return yScale(d)})
					.interpolate("linear");	

			//put the circles in!!
			group.selectAll("circle")
	        .data(beginValue)
			.enter()
			.append("circle")
			.attr("cx", "0")
			.attr("cy", function(d){
                 return yScale(d);})
			.attr("r", 5)	
			.attr("stroke", "black")
			.attr("fill", function(d, i){
				if (i == 0) {return colorArray[i]}
				else{if(i == 1) {return colorArray[i]}
					 else{if(i ==2) {return colorArray[i]}
					      else{if(i ==3){return colorArray[i]}
						       else{if(i==4) {return colorArray[i]}
									else{if(i == 5) {return colorArray[i]}
									     else{return colorArray[i]}
										}
									}	
								}
							}
					}
				});
			var regionsArray = ["North America", "Central & South America", "Europe", "Eurasia", "Africa", "Asia & Oceania"];		
			//put labels for each circle
			group.selectAll("text")
			   .data(regionsArray)
			   .enter()
			   .append("text")
			   .text(function(d, i){
				if (i == 0) {return regionsArray[i]}
				else{if(i == 1) {return regionsArray[i]}
					 else{if(i ==2) {return regionsArray[i]}
					      else{if(i ==3){return regionsArray[i]}
						       else{if(i==4) {return regionsArray[i]}
									else{if(i == 5) {return regionsArray[i]}
									     else{return regionsArray[i]}
										}
									}	
								}
							}
					}
				})
			   .attr("x", "0")
			   .attr("y", function(d, i){
				if (i == 0) {return yScale(beginValue[i])}
				else{if(i == 1) {return yScale(beginValue[i])}
					 else{if(i ==2) {return yScale(beginValue[i])}
					      else{if(i ==3){return yScale(beginValue[i])}
						       else{if(i==4) {return yScale(beginValue[i])}
									else{if(i == 5) {return yScale(beginValue[i])}
									     else{return yScale(beginValue[i])}
										}
									}	
								}
							}
					}
				})
			   .attr("font-family", "sans-serif")
			   .attr("font-size", "10px")
			   .attr("fill", "black");
			   
	d3.select("#main").append("circle")
			.attr("cx", 100)
			.attr("cy", 445)
			.attr("r", 15)
			.attr("fill","#ffffff")
			
			
		d3.select("#main").append("circle")
			.attr("cx", 300)
			.attr("cy", 445)
			.attr("r", 15)
			.attr("fill","#ffffff")


				
//LATER//add a line to see how the circles move more closely
				
			var AAA = [100, 300, 200, 400, 40, 230, 35, 555]
			var AA = chartWidth / 33
			var yearYear = 1980;
			
				
			
			//여기부터가 대환장파티....

			//i값이 20이면 a값이 1이 된다. 펑션 안에서, a값이 1이면 100을 리턴한다.
			//i값은 계속 증가, i값 증가에 따라 a값도 변화. a값에 따라서 다른 결과를 리턴한다.
			/*update = function(){
			d3.selectAll("circle")
				.transition()
				.ease("backs")
				.duration(1000)
				.attr("cy", 400)
				.transition()
				.ease("backs")
				.duration(1000)
				.attr("cx", 500);*/
							
			//}
			
	/*		
			//should call this function multiple times. 
			//and the value yLocation finds is changing every time
			
			update = function(){
				d3.selectAll("circle")
				.transition()
				.ease("backs")
				.duration(1000)
				.attr("cy", function(d, i){			
							if(i == 1) {
							return AAA[ccc]
							}//on circle no.1
							/*if(i == 1) {yLocation(i);}
							if(i == 2) {yLocation(i);}
							if (i == 3) {yLocation(i);}
							if (i == 4){yLocation(i);}
							if (i == 5){yLocation(i);}*/
							/*if(i == 6){yLocation(i);}
							if(i == 7){yLocation(i);}
							if (i == 8){yLocation(i);}
							if (i == 9){yLocation(i);}
							if (i == 10){yLocation(i);}
							if(i == 11){yLocation(i);}
							if(i == 12){yLocation(i);}
							if (i == 13){yLocation(i);}
							if (i == 14){yLocation(i);}
							if (i == 15){yLocation(i);}
							if(i == 16){yLocation(i);}
							if(i == 17){yLocation(i);}
							if (i == 18){yLocation(i);}
							if (i == 19){yLocation(i);}
							if (i == 20){yLocation(i);}
							if(i == 21){yLocation(i);}
							if(i == 22){yLocation(i);}
							if (i == 23){yLocation(i);}
							if (i == 24){yLocation(i);}
							if (i == 25){yLocation(i);}
							if(i == 26){yLocation(i);}
							if(i == 27){yLocation(i);}
							if (i == 28){yLocation(i);}
							if (i == 29){yLocation(i);}
							if (i == 30){yLocation(i);}
							if (i == 31){yLocation(i);}
							if (i == 32){yLocation(i);}console.log(i)
						}
					)
				.transition()
				.ease("backs")
				.duration(1000)	
				.attr("cx", AAA[ccc])
				}
			for (var i = 0; i < 5; i++) {
			update();
			console.log(i)
			ccc = i;}*/
			
			/*var yLocation = function(i) {return prepareData1[i]}
				for (var a = 0; a < 32; a++) {;}*/
				
				
			
			//for loop that increases by 1 when button is pressed
			//onclick of a button
			//another variable year. it gets increased by 1 as well inside the loop.
			//display year at the center of teh chart
			//when year is == 1, var Location of Y (of that circle) = prepareData1[1]. then [2]
			//and then inside that transition function, var year goes inside. 
			
			
			
			//and that for loop ends here

			 
			//codes related to scales
			
			//draw x axis from 1980 to 2012 and y axis scaled for the maximum value	
			var timeScale = d3.time.scale()
				.domain([new Date(1980, 1, 1), new Date(2012, 1, 1)])
				.range([0, 500]);  
				
			var xAxis = d3.svg.axis()
					.scale(timeScale)
					.orient('bottom');
					
				group.append("g")
					.attr('class', 'axis')
					.attr('transform', 'translate(0,' + chartHeight + ')')
					.call(xAxis);
					
			var yAxis = d3.svg.axis()
					.scale(yScale)
					.orient('left');

				group.append("g")
					.attr('class', 'axis')
					.attr('transform', 'translate(-2,0)')
					.call(yAxis);	
	d3.select("#var1")
		.attr("fill", "	#FFFFFF")
	d3.select("#var2")
		.attr("fill", "	#FFFFFF")				
	
	};
//drawing static scattterplot

function drawScatter(selectedRegion1, selectedRegion2, selectedEnergyId) {
	var prepareData = selectedEnergyId[selectedRegion1].energyProduction;	
	var prepareData2 = selectedEnergyId[selectedRegion2].energyProduction;	

	var dataset = [];
		for (var i = 0; i<prepareData.length; i++){
			if (typeof prepareData[i] == "number" ) {dataset.push(prepareData[i])}
			else {prepareData[i] = 0; dataset.push(prepareData[i]);}
		};
	var dataset2 = [];
		for (var i = 0; i<prepareData2.length; i++){
			if (typeof prepareData2[i] == "number" ) {dataset2.push(prepareData2[i])}
			else {prepareData2[i] = 0; dataset2.push(prepareData2[i]);}
		};
		
	var maxProduction = 0; 
			//maximum data point may be different for each dataset, so compare and take whichever is higher 
		if (d3.max(dataset) >= d3.max(dataset2)) {maxProduction = d3.max(dataset)}
		else if (d3.max(dataset) < d3.max(dataset2)){maxProduction = d3.max(dataset2)};
	
	// chart size 
	var chartWidth = 500;
	var chartHeight = 300;	
	
	var scatterWidth = chartWidth / (dataset.length -1);
	
	var yScale = d3.scale.linear()
				.domain([0, maxProduction])
				.range([chartHeight, 0]);
				
	var datasetCombined = dataset.concat(dataset2)
	var datasetBlank = [];
	var whichDataToUse = 0;
		
	//here, determine which dataset to pass depending on what is passed
	//if selectedRegion == invalid answer, check if region 2 is also invalid. If so, return 0.
		//means datasetBlank
	//if selected Region == invalid, but region2 is valid, draw it only.
	//same for region2
	//if both are valid, return 1 as both being valid
	
	if (selectedRegion1 == "---Select---"){
		if(selectedRegion2 == "---Select---") {whichDataToUse = 0;}
		else {whichDataToUse = 3;} 
	}
	else if(selectedRegion2 == "---Select--") {whichDataToUse = 2;}
	else{whichDataToUse = 1;}
	
	var selection= document.getElementById('energyType');
	var selectedEnergy = selection.options[selection.selectedIndex].value;
	
	var scaleDisplay = '';
			function dp (selectedEnergy) {
				if(selectedEnergy == "Total Primary Energy Production") {scaleDisplay ="(Quadrillion BTU)"}
				else if(selectedEnergy == "Total Primary Energy Consumption") {scaleDisplay ="(Quadrillion BTU)"}
				else if(selectedEnergy == "Total Electricity Production") {scaleDisplay = "(billion Kilowatt-hours)"}
				else if(selectedEnergy == "Total Electricity Consumption") {scaleDisplay = "(billion Kilowatt-hours)"}
				else if(selectedEnergy == "Renewable Electricity Production") {scaleDisplay = "(billion Kilowatt-hours)"}
				else if(selectedEnergy == "Renewable Electricity Consumption") {scaleDisplay = "(billion Kilowatt-hours)"}
				else if(selectedEnergy == "Renewable Biofuel Production") {scaleDisplay = "(thousand barrels per day)"}
				else if(selectedEnergy == "Renewable Biofuel Consumption") {scaleDisplay = "(thousand barrels per day)"}
				else if(selectedEnergy == "Petroleum Production") {scaleDisplay = "(thousand barrels per day)"}
				else if(selectedEnergy == "Petroleum Consumption") {scaleDisplay = "(thousand barrels per day)"}
				else if(selectedEnergy == "Coal Production") {scaleDisplay = "(million short tons)"}
				else if(selectedEnergy == "Coal Consumption") {scaleDisplay = "(million short tons)"}
				else if(selectedEnergy == "CO2 Emission per Capita") {scaleDisplay = "(metric tons per capita)"}
			}
	dp (selectedEnergy);
	
d3.select("#titleData")
	   .html(selectedEnergy + " of " + selectedRegion1 + " and " + selectedRegion2)
    d3.select("#scale")
	   .html(scaleDisplay)


	//division point means that after this point of array, data belongs to the second dataset.
	var divisionPoint = Number(dataset.length)
	
	var datasetCombined = dataset.concat(dataset2)
	var datasetBlank = [];
    var group = d3.select("#main").append("g")
              .attr("transform", "translate(100, 100)");
       group.selectAll("circle")
	        .data(function(d){
						if (whichDataToUse == 1){
						return datasetCombined
						}
						else if (whichDataToUse == 2){
						return dataset
						}
						else if (whichDataToUse ==3) {
						return dataset2
						}
						else {
						return datasetBlank}})
			.enter()
			.append("circle")
			//starting point should not be zero because then the result will be different from bar chart
			.attr("cx", function(d, i) {

			if (divisionPoint<33) {
				if (i<divisionPoint) {return i*scatterWidth}
				else {return (i-divisionPoint) * scatterWidth}
			}
			else {
				if (i<33) {return i*scatterWidth}
				else {return (i-33) * scatterWidth}
				}
			
			})
			.attr("cy", function(d){
                 return yScale(d);})
			.attr("r", 3)	
			.style("fill", function(d, i){
				if(whichDataToUse == 1){
			    if (divisionPoint<33){
				  if (i<divisionPoint) {
				      return "#99ccff"}
				  else {return "#ff9966"}}
				else {
					if (i<33) {return "#99ccff"}
					else {return "#ff9966"}
				}}
				else if(whichDataToUse == 2) {return "#99ccff"}
				else if(whichDataToUse ==3) {return "#ff9966"}
			})
			.on("mouseover", function() {d3.select(this)
			   			.attr("r", 10)})
			.on("mouseout", function() {d3.select(this)
			   			.attr("r", 3)})
						
			.append("title")
			.text(function(d, i) {if (whichDataToUse == 1){
								if (i < divisionPoint) {return selectedRegion1 + ': ' + d + '   ' +'in ' + (i+ 1980)}
								else {return selectedRegion2 + ': ' + d + '   ' +'in ' + (i - 33+ 1980)}
							    }
							    else if(whichDataToUse == 2){{return selectedRegion1 + ': ' + d + '   ' +'in ' + (i+ 1980)}
								}
							   else if(whichDataToUse == 3){{return selectedRegion2 + ': ' + d + '   ' +'in ' + (i+ 1980)}
								}
							   });
							   
	d3.select("#main").append("circle")
			.attr("cx", 100)
			.attr("cy", 445)
			.attr("r", 15)
			.attr("fill","#99ccff")
			
		d3.select("#main").append("circle")
			.attr("cx", 400)
			.attr("cy", 445)
			.attr("r", 15)
			.attr("fill","#ff9966")
			
		d3.select("#textVar1")
		  .html(selectedRegion1)
		d3.select("#textVar2")
		  .html(selectedRegion2)				   
							   

/*var legendArray = [200, 220]
var legendArray2 = [300, 400, 320, 400];

var legendA = d3.svg.line()
	                .x(function(d, i) {legendArray[i]})
					//this should apply to dataset with less years
					.y(400)
					.interpolate("linear");		
					
		group.append("path")
	                 .attr("class", "line")
                     .attr("d", legendA(legendArray))
                     .attr("stroke", "#0088cc")
                     .attr("stroke-width", 2)
                     .attr("fill", "none");*/
	
			
			
			//put labels for each circle
			/*group.selectAll("text")
			   .data(function(d){
						if (whichDataToUse == 1){
						return datasetCombined
						}
						else if (whichDataToUse == 2){
						return dataset
						}
						else if (whichDataToUse ==3) {
						return dataset2
						}
						else {
						return datasetBlank}})
			   .enter()
			   .append("text")
			   .text(function(d, i) {

			if (divisionPoint<33) {
				if (i<divisionPoint) {return i*scatterWidth}
				else {return (i-divisionPoint) * scatterWidth}
			}
			else {
				if (i<33) {return i*scatterWidth}
				else {return (i-33) * scatterWidth}
				}
			
			})
			    .attr("x", function(d, i) {

			if (divisionPoint<33) {
				if (i<divisionPoint) {return i*scatterWidth}
				else {return (i-divisionPoint) * scatterWidth}
			}
			else {
				if (i<33) {return i*scatterWidth}
				else {return (i-33) * scatterWidth}
				}
			
			})
			   .attr("y", function(d){return yScale(d);})
			   .attr("font-family", "sans-serif")
			   .attr("font-size", "10px")
			   .attr("fill", "black");*/
			
	        var timeScale = d3.time.scale()
				.domain([new Date(1980, 1, 1), new Date(2012, 1, 1)])
				  .range([0, 500])  
		
			var xAxis = d3.svg.axis()
				.scale(timeScale)
				.orient('bottom')
				
			group.append("g")
				.attr('class', 'axis')
				.attr('transform', 'translate(0,' + chartHeight + ')')
				.call(xAxis)

			var yAxis = d3.svg.axis()
				.scale(yScale)
				.orient('left');

			group.append("g")
				.attr('class', 'axis')
				.attr('transform', 'translate(-2,0)')
				.call(yAxis);
	//see if can cahnge circle color

	}
		
//create a bar chart and a line chart for comparing two regions with same energy type and same year span

function drawBar(selectedRegion1, selectedRegion2, selectedEnergyId) {

	var prepareData = selectedEnergyId[selectedRegion1].energyProduction;	
	var prepareData2 = selectedEnergyId[selectedRegion2].energyProduction;	

	var dataset = [];
		for (var i = 0; i<prepareData.length; i++){
			if (typeof prepareData[i] == "number" ) {dataset.push(prepareData[i])}
			else {prepareData[i] = 0; dataset.push(prepareData[i]);}
		};
	var dataset2 = [];
		for (var i = 0; i<prepareData2.length; i++){
			if (typeof prepareData2[i] == "number" ) {dataset2.push(prepareData2[i])}
			else {prepareData2[i] = 0; dataset2.push(prepareData2[i]);}
		};
		
	// figure out maximum energy production
	var maxProduction = 0; 
			//maximum data point may be different for each dataset, so compare and take whichever is higher 
		if (d3.max(dataset) >= d3.max(dataset2)) {maxProduction = d3.max(dataset)}
		else if (d3.max(dataset) < d3.max(dataset2)){maxProduction = d3.max(dataset2)};
	
	// chart size 
	var chartWidth = 500;
	var chartHeight = 300;

	// figure out the width of individual bars
	var barWidth = chartWidth / (2012-1980+1);

	// create a y scale
	var yScale = d3.scale.linear()
		.domain([0, maxProduction])
		.range([chartHeight, 0]);

	//create title
	var selection= document.getElementById('energyType');
	var selectedEnergy = selection.options[selection.selectedIndex].value;
	
	var scaleDisplay = '';
			function dp (selectedEnergy) {
				if(selectedEnergy == "Total Primary Energy Production") {scaleDisplay ="(Quadrillion BTU)"}
				else if(selectedEnergy == "Total Primary Energy Consumption") {scaleDisplay ="(Quadrillion BTU)"}
				else if(selectedEnergy == "Total Electricity Production") {scaleDisplay = "(billion Kilowatt-hours)"}
				else if(selectedEnergy == "Total Electricity Consumption") {scaleDisplay = "(billion Kilowatt-hours)"}
				else if(selectedEnergy == "Renewable Electricity Production") {scaleDisplay = "(billion Kilowatt-hours)"}
				else if(selectedEnergy == "Renewable Electricity Consumption") {scaleDisplay = "(billion Kilowatt-hours)"}
				else if(selectedEnergy == "Renewable Biofuel Production") {scaleDisplay = "(thousand barrels per day)"}
				else if(selectedEnergy == "Renewable Biofuel Consumption") {scaleDisplay = "(thousand barrels per day)"}
				else if(selectedEnergy == "Petroleum Production") {scaleDisplay = "(thousand barrels per day)"}
				else if(selectedEnergy == "Petroleum Consumption") {scaleDisplay = "(thousand barrels per day)"}
				else if(selectedEnergy == "Coal Production") {scaleDisplay = "(million short tons)"}
				else if(selectedEnergy == "Coal Consumption") {scaleDisplay = "(million short tons)"}
				else if(selectedEnergy == "CO2 Emission per Capita") {scaleDisplay = "(metric tons per capita)"}
			}
	dp (selectedEnergy);
	//putting titles in
	d3.select("#titleData")
	   .html(selectedEnergy + " of " + selectedRegion1 + " and " + selectedRegion2)
    d3.select("#scale")
	   .html(scaleDisplay)
	// create a group for the bar chart


	var group = d3.select("#main").append("g")
		.attr("transform", "translate(100, 100)");

	//division point means that after this point of array, data belongs to the second dataset.
	var divisionPoint = Number(dataset.length)
		
	var datasetCombined = dataset.concat(dataset2)
	var datasetBlank = [];
	var whichDataToUse = 0;
		
	//here, determine which dataset to pass depending on what is passed
	//if selectedRegion == invalid answer, check if region 2 is also invalid. If so, return 0.
		//means datasetBlank
	//if selected Region == invalid, but region2 is valid, draw it only.
	//same for region2
	//if both are valid, return 1 as both being valid
	
	if (selectedRegion1 == "---Select---"){
		if(selectedRegion2 == "---Select---") {whichDataToUse = 0;}
		else {whichDataToUse = 3;} 
	}
	else if(selectedRegion2 == "---Select--") {whichDataToUse = 2;}
	else{whichDataToUse = 1;}

	
	
	
	group.selectAll("rect")
				.data(function(d){
						if (whichDataToUse == 1){
						return datasetCombined
						}
						else if (whichDataToUse == 2){
						return dataset
						}
						else if (whichDataToUse ==3) {
						return dataset2
						}
						else {
						return datasetBlank}})
				.enter().append('rect')
				.attr("x", function(d, i) { 
					
					if (divisionPoint < 33) {
						if (i <divisionPoint) {return i*(barWidth)}
						else {return (i-divisionPoint) * (barWidth)}
					}
					else {
						if (i <33) {return i*(barWidth)}
						else {return (i-33) * (barWidth)}
					}
				})
				.attr("y", function(d, i) { 
					return yScale(d);
				})
				.attr("width", barWidth)
				.attr("height", function(d) { 
					return chartHeight - yScale(d); 
				})
				.attr("id", "rectColor")
				/*.on("mouseover", function() {d3.select(this)
			   			.attr("fill", "green")})
				.on("mouseout", function() {d3.select(this)
			   			.attr("fill", "blue")})*/
				.style("stroke", "white")
				.style("opacity", "0.7")
				.style("fill", function(d, i){
				//depending on the dataset, color will be different
				  if (whichDataToUse == 1){
					if (i <divisionPoint) {
				      return "#99ccff"}
					else {return "#ff9966"}}
				  else if(whichDataToUse == 2) {return "#99ccff"}
				  else if(whichDataToUse ==3) {return "#ff9966"}
				})
				
				.append("title")
				.text(function(d, i) {if (whichDataToUse == 1){
								if (i < divisionPoint) {return selectedRegion1 + ': ' + d}
								else {return selectedRegion2 + ': ' + d}
							    }
							    else if(whichDataToUse == 2){{return selectedRegion1 +  ': ' + d}
								}
							   else if(whichDataToUse == 3){{return selectedRegion2 +  ': ' + d}
								}
							   });
			d3.select("#main").append("circle")
			.attr("cx", 100)
			.attr("cy", 445)
			.attr("r", 15)
			.attr("fill","#99ccff")
			
		d3.select("#main").append("circle")
			.attr("cx", 400)
			.attr("cy", 445)
			.attr("r", 15)
			.attr("fill","#ff9966")
			
		d3.select("#textVar1")
		  .html(selectedRegion1)
		d3.select("#textVar2")
		  .html(selectedRegion2)				   
							   
							   
				
	//create labels

			// create x axis
			var timeScale = d3.time.scale()
				.domain([new Date(1980, 1, 1), new Date(2012, 1, 1)])
				.range([0, chartWidth])

			var xAxis = d3.svg.axis()
				.scale(timeScale)
				.orient('bottom');

			// create y axis
			group.append("g")
				.attr('class', 'axis')
				.attr('transform', 'translate(0,' + chartHeight + ')')
				.call(xAxis);

			var yAxis = d3.svg.axis()
				.scale(yScale)
				.orient('left');

			group.append("g")
				.attr('class', 'axis')
				.attr('transform', 'translate(-2,0)')
				.call(yAxis);
}

function drawLine(selectedRegion1, selectedRegion2, selectedEnergyId)  {
	var prepareData = selectedEnergyId[selectedRegion1].energyProduction;	
	var prepareData2 = selectedEnergyId[selectedRegion2].energyProduction;	

		var dataset = [];
		for (var i = 0; i<prepareData.length; i++){
			if (typeof prepareData[i] == "number" ) {dataset.push(prepareData[i])}
			else {prepareData[i] = 0; dataset.push(prepareData[i]);}
		};
	var dataset2 = [];
		for (var i = 0; i<prepareData2.length; i++){
			if (typeof prepareData2[i] == "number" ) {dataset2.push(prepareData2[i])}
			else {prepareData2[i] = 0; dataset2.push(prepareData2[i]);}
		};
		
	// figure out maximum energy production
	var maxProduction = 0; 
			//maximum data point may be different for each dataset, so compare and take whichever is higher 
		if (d3.max(dataset) >= d3.max(dataset2)) {maxProduction = d3.max(dataset)}
		else if (d3.max(dataset) < d3.max(dataset2)){maxProduction = d3.max(dataset2)};
	
	// chart size 
	var chartWidth = 500;
	var chartHeight = 300;
	///this is actually width for each line segment
	var scatterWidth = chartWidth / (dataset.length -1);
	
	var yScale = d3.scale.linear()
				.domain([0, maxProduction])
				.range([chartHeight, 0]);
	var datasetCombined = dataset.concat(dataset2)
	var datasetBlank = [];
	
	var whichDataToUse = 0;
		
	//here, determine which dataset to pass depending on what is passed
	//if selectedRegion == invalid answer, check if region 2 is also invalid. If so, return 0.
		//means datasetBlank
	//if selected Region == invalid, but region2 is valid, draw it only.
	//same for region2
	//if both are valid, return 1 as both being valid
	
	if (selectedRegion1 == "---Select---"){
		if(selectedRegion2 == "---Select---") {whichDataToUse = 0;}
		else {whichDataToUse = 3;} 
	}
	else if(selectedRegion2 == "---Select--") {whichDataToUse = 2;}
	else{whichDataToUse = 1;}

	var lineValue = d3.svg.line()
	                .x(function(d, i) { 
					return scatterWidth * i})
					//this should apply to dataset with less years
					.y(function(d){return yScale(d)})
					.interpolate("linear");		
					
	//create title
	var selection= document.getElementById('energyType');
	var selectedEnergy = selection.options[selection.selectedIndex].value;
	
	var scaleDisplay = '';
			function dp (selectedEnergy) {
				if(selectedEnergy == "Total Primary Energy Production") {scaleDisplay ="(Quadrillion BTU)"}
				else if(selectedEnergy == "Total Primary Energy Consumption") {scaleDisplay ="(Quadrillion BTU)"}
				else if(selectedEnergy == "Total Electricity Production") {scaleDisplay = "(billion Kilowatt-hours)"}
				else if(selectedEnergy == "Total Electricity Consumption") {scaleDisplay = "(billion Kilowatt-hours)"}
				else if(selectedEnergy == "Renewable Electricity Production") {scaleDisplay = "(billion Kilowatt-hours)"}
				else if(selectedEnergy == "Renewable Electricity Consumption") {scaleDisplay = "(billion Kilowatt-hours)"}
				else if(selectedEnergy == "Renewable Biofuel Production") {scaleDisplay = "(thousand barrels per day)"}
				else if(selectedEnergy == "Renewable Biofuel Consumption") {scaleDisplay = "(thousand barrels per day)"}
				else if(selectedEnergy == "Petroleum Production") {scaleDisplay = "(thousand barrels per day)"}
				else if(selectedEnergy == "Petroleum Consumption") {scaleDisplay = "(thousand barrels per day)"}
				else if(selectedEnergy == "Coal Production") {scaleDisplay = "(million short tons)"}
				else if(selectedEnergy == "Coal Consumption") {scaleDisplay = "(million short tons)"}
				else if(selectedEnergy == "CO2 Emission per Capita") {scaleDisplay = "(metric tons per capita)"}
			}
	dp (selectedEnergy);
	//putting titles in
	d3.select("#titleData")
	   .html(selectedEnergy + " of " + selectedRegion1 + " and " + selectedRegion2)
    d3.select("#scale")
	   .html(scaleDisplay)
	var group = d3.select("#main").append("g")
		.attr("transform", "translate(100, 100)");
		
	var group = d3.select("#main").append("g")
              .attr("transform", "translate(100, 100)");
		//when there should be two lines.
		  if (whichDataToUse == 1) {
				group.append("path")
	                 .attr("class", "line")
					 .attr("id", "lineGraphLine")
                     .attr("d", lineValue(dataset))
                     .attr("stroke", "#0088cc")
                     .attr("stroke-width", 2)
					 .attr("id", "line1")
                     .attr("fill", "none");
				group.append("path")
	                 .attr("class", "line")
					 .attr("id", "lineGraphLine2")
                     .attr("d", lineValue(dataset2))
                     .attr("stroke", "#ff661a")
                     .attr("stroke-width", 2)
					 .attr("id", "line2")
                     .attr("fill", "none");	}

		  else if (whichDataToUse ==2) {
			group.append("path")
	                 .attr("class", "line")
					 .attr("id", "lineGraphLine")
                     .attr("d", lineValue(dataset))
                     .attr("stroke", "#0088cc")
                     .attr("stroke-width", 2)
                     .attr("fill", "none");
		  }
		  else if (whichDataToUse == 3) {
			group.append("path")
	                 .attr("class", "line")
					 .attr("id", "lineGraphLine")
                     .attr("d", lineValue(dataset2))
                     .attr("stroke", "#ff661a")
                     .attr("stroke-width", 2)
                     .attr("fill", "none");
		  }
     var divisionPoint = Number(dataset.length)
	
	var datasetCombined = dataset.concat(dataset2)

		  //add circles for datapoints
		  group.selectAll("circle")
	        .data(function(d){
						if (whichDataToUse == 1){
						return datasetCombined
						}
						else if (whichDataToUse == 2){
						return dataset
						}
						else if (whichDataToUse ==3) {
						return dataset2
						}
						else {
						return datasetBlank}})
			.enter()
			.append("circle")
			//starting point should not be zero because then the result will be different from bar chart
			.attr("cx", function(d, i) {

			if (divisionPoint<33) {
				if (i<divisionPoint) {return i*scatterWidth}
				else {return (i-divisionPoint) * scatterWidth}
			}
			else {
				if (i<33) {return i*scatterWidth}
				else {return (i-33) * scatterWidth}
				}
			
			})
			.attr("cy", function(d){
                 return yScale(d);})
			.attr("r", 3)	
			.style("fill", function(d, i){
				if(whichDataToUse == 1){
			    if (divisionPoint<33){
				  if (i<divisionPoint) {
				      return "#0088cc"}
				  else {return "#ff661a"}}
				else {
					if (i<33) {return "#0088cc"}
					else {return "#ff661a"}
				}}
				else if(whichDataToUse == 2) {return "#0088cc"}
				else if(whichDataToUse ==3) {return "#ff661a"}
			})
			.on("mouseover", function() {d3.select(this)
			   			.attr("r", 8)})
			.on("mouseout", function() {d3.select(this)
			   			.attr("r", 3)})
			.append("title")
			.text(function(d, i) {if (whichDataToUse == 1){
								if (i < divisionPoint) {return selectedRegion1 + ': ' + d + '   ' +'in ' + (i+ 1980)}
								else {return selectedRegion2 + ': ' + d + '   ' +'in ' + (i - 33+ 1980)}
							    }
							    else if(whichDataToUse == 2){{return selectedRegion1 + ': ' + d + '   ' +'in ' + (i+ 1980)}
								}
							   else if(whichDataToUse == 3){{return selectedRegion2 + ': ' + d + '   ' +'in ' + (i+ 1980)}
								}
							   })
							   
		  d3.select("#main").append("circle")
			.attr("cx", 100)
			.attr("cy", 445)
			.attr("r", 15)
			.attr("fill","#0088cc")
			
		d3.select("#main").append("circle")
			.attr("cx", 400)
			.attr("cy", 445)
			.attr("r", 15)
			.attr("fill","#ff661a")
			
		d3.select("#textVar1")
		  .html(selectedRegion1)
		d3.select("#textVar2")
		  .html(selectedRegion2)
		 
		 
		  ;
		  // create x axis
			var timeScale = d3.time.scale()
				.domain([new Date(1980, 1, 1), new Date(2012, 1, 1)])
				.range([0, chartWidth])

			var xAxis = d3.svg.axis()
				.scale(timeScale)
				.orient('bottom');

			// create y axis
			group.append("g")
				.attr('class', 'axis')
				.attr('transform', 'translate(0,' + chartHeight + ')')
				.call(xAxis);

			var yAxis = d3.svg.axis()
				.scale(yScale)
				.orient('left');

			group.append("g")
				.attr('class', 'axis')
				.attr('transform', 'translate(-2,0)')
				.call(yAxis);
	d3.select("#var1")
		.attr("fill", "#0088cc")
	d3.select("#var2")
		.attr("fill", "#ff661a")	
}

/*function blankGraph() {
			var timeScale = d3.time.scale()
				.domain([new Date(1980, 1, 1), new Date(2012, 1, 1)])
				.range([0, chartWidth])
				
			var yScale = d3.scale.linear()
				.domain([0, 1000])
				.range([chartHeight, 0]);

			var xAxis = d3.svg.axis()
				.scale(timeScale)
				.orient('bottom');

			// create y axis
			group.append("g")
				.attr('class', 'axis')
				.attr('transform', 'translate(0,' + chartHeight + ')')
				.call(xAxis);

			var yAxis = d3.svg.axis()
				.scale(yScale)
				.orient('left');

			group.append("g")
				.attr('class', 'axis')
				.attr('transform', 'translate(-2,0)')
				.call(yAxis);

}*/
		
	//disabling and enabling dropdown fro regions
			function disableRegion1() {document.getElementById("region1").disabled=true;}
			function disableRegion2() {document.getElementById("region2").disabled=true;}
			function enableRegion1() {document.getElementById("region1").disabled=false;}
			function enableRegion2() {document.getElementById("region2").disabled=false;}	
	//function for creating legend
	//two circles (more for animated scatterplot) side by side
	//+ text displaying region name
	
	/*var cirLocation1 = [50, 400] 
	var cirLocation2 = [80, 400]
	function legendCreate() {
	d3.selectAll("circle")
		.data(cirLocation1)
		.enter()
		.append("circle")
		.attr("cx", function(d,i){if (i== 0){return cirLocation1[0]} else if(i==1) {return cirLocation2[0]}})
		.attr("cy", function(d,i){if (i== 0){return cirLocation1[1]} else if(i==1) {return cirLocation2[1]}})
		.attr("r", "30")
		.attr("fill", "red")
	}
	legendCreate();*/
	
	

		
</script>
</body>


</html>
